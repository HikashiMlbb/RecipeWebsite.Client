<div *ngIf="recipe && !isLoading; then content; else loading"></div>

<!-- Content -->
<ng-template #content>
    <div class="recipe">
        <h1>{{ recipe.title }}</h1>
        <div class="header">
            <div class="image">
                <img [src]="recipe.image" >
            </div>
            <div class="header-content">
                <div *ngIf="recipe.isModifyAllowed" class="modify">
                    <a [routerLink]="['/edit', recipe.id]"><input type="button" value="–ò–∑–º–µ–Ω–∏—Ç—å" /></a>
                    <input (click)="deleteRecipe()" type="button" [value]="isDeletingSure ? '–í—ã —É–≤–µ—Ä–µ–Ω—ã?' : '–£–¥–∞–ª–∏—Ç—å'">
                </div>
                <p>–ê–≤—Ç–æ—Ä —Ä–µ—Ü–µ–ø—Ç–∞: <a [routerLink]="['/profile', recipe.author.id]">{{ recipe.author.username }}</a></p>
                <p>–û—Ü–µ–Ω–∫–∞: <b>{{ recipe.rating }}</b>üåü ({{ recipe.votes }} –æ—Ü–µ–Ω–æ–∫)</p>
                <p *ngIf="isAuthenticated && !isUserAuthor" class="rate-view">–í–∞—à–∞ –æ—Ü–µ–Ω–∫–∞:
                    <svg
                        class="star"
                        [class.disabled]="!isAuthenticated || isUserAuthor" 
                        *ngFor="let _ of starsCount; index as i" 
                        (click)="starRateClicked(i)"
                        [class.fired]="getStarClass(i)"
                        (mouseover)="starRateHovered(i)"
                        (mouseout)="starRateHovered(-1)"
                        height="30" 
                        width="30" 
                        viewBox="0 0 800 800" 
                        xmlns="http://www.w3.org/2000/svg">
                        <polygon points="400,50 500,300 750,300 550,500 650,750 400,600 150,750 250,500 50,300 300,300" />
                    </svg>
                </p>
                <p>–°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ—Ü–µ–ø—Ç–∞: <b [ngClass]="difficultyClasses">{{ viewRecipeDifficulty() }}</b></p>
                <p>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≥–æ—Ç–æ–≤–∫–∏: {{ cookingTime }}</p>
            </div>
        </div>
    </div>
    <div class="description">
        <h1>–û–ø–∏—Å–∞–Ω–∏–µ</h1>
        <p>{{ recipe.description }}</p>
    </div>
    <div class="ingredients">
        <h1>–ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã</h1>
        <ul>
            <li *ngFor="let ingredient of recipe.ingredients">
                    <span>{{ ingredient.name }} - {{ ingredient.count }} {{ viewIngredientMeasurementType(ingredient.measurementUnit) }}</span>
            </li>
        </ul>
    </div>
    <div>
        <h1>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—é</h1>
        <p>{{ recipe.instruction }}</p>
    </div>
    <div class="comments">
        <h1>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h1>
        <form [formGroup]="commentForm" (ngSubmit)="onSubmit()">
            <textarea
                [readOnly]="!isAuthenticated"
                [class.error-input]="commentForm.get('comment')!.invalid && commentForm.get('comment')!.touched && isAuthenticated"
                formControlName="comment" 
                [placeholder]="isAuthenticated ? '–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π' : '–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π.'"></textarea>
            <p class="error" *ngIf="commentForm.get('comment')!.invalid && commentForm.get('comment')!.touched && isAuthenticated">
                –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç {{ maxCommentLength }} —Å–∏–º–≤–æ–ª–æ–≤, –∞ —Ç–∞–∫–∂–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º.
            </p>
            <input [disabled]="!isAuthenticated" type="submit" value="–û—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π">
        </form>
        <div *ngIf="recipe.comments.length == 0">
            <h2>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ–∫–∞ —á—Ç–æ –Ω–µ—Ç...</h2>
        </div>
        <div *ngFor="let comment of recipe.comments" class="comment">
            <h2>
                <a [routerLink]="[ '/profile', comment.userId]">
                    {{ comment.username }}:
                </a>
            </h2>
            <p>{{ comment.content }}</p>
        </div>
    </div>
</ng-template>

<!-- Loading -->
<ng-template #loading>
    <div class="loading">
        <h1>–ó–∞–≥—Ä—É–∑–∫–∞...</h1>
    </div>
</ng-template>
